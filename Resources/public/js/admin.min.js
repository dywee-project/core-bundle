function validate_ajax_form(a){var b={form_name:"MyFormName",container_id:"#modalForm",target_success:{dom:".#Target",element_to_add:"<tr>__content__</tr>"},button_validate:{dom:".#SubmitButton",text_waiting:'<i class="fa fa-spin fa-spinner"></i> Please wait',class_waiting:"disabled"}};$.each(a,function(c,d){b[c]=a[c]}),$(b.button_validate.dom).on("click",function(a){a.preventDefault();var c=$('[name="'+b.form_name+'"]'),d=$('[name="'+b.form_name+'"] input, select, textarea'),e={};$.each(d,function(a,b){e[b.id]=b.value});var f=$(this).html();$(this).html(b.button_validate.text_waiting),$(this).attr("disabled","disabled"),$(this).toggleClass(b.button_validate.class_waiting),$.ajax({type:"POST",url:c.attr("action"),dataType:"json",data:e,success:function(a){var c=$(b.target_success.dom);c.append(b.target_success.element_to_add.replace("__content__",a.content)),$(b.container_id).modal("hide")},error:function(){$(this).html(f),$(this).toggleClass(b.button_validate.class_waiting),$(this).removeAttr("disabled")}})})}function dywee_handle_form_collection(a){dywee_handle_form_collection(a,null)}function dywee_handle_form_collection(a,b){function h(a){try{var b=$(a.attr("data-prototype").replace(/__name__label__/g,c.label+" n°"+(f+1)).replace(/__name__/g,f))}catch(b){var b=$(a.attr("data-prototype"))}c.allow_delete&&i(b),a.append(b),f++,$(".select2").select2()}function i(a){""==c.remove_btn.icon?$deleteLink=$('<a href="#" class="'+c.remove_btn.class+'">'+c.remove_btn.text+"</a>"):$deleteLink=$('<a href="#" class="'+c.remove_btn.class+'"><i class="'+c.remove_btn.icon+'"></i> '+c.remove_btn.text+"</a>"),""==c.remove_btn.target?a.append($deleteLink):a.find(c.remove_btn.target).html($deleteLink),$deleteLink.click(function(b){return a.remove(),b.preventDefault(),!1})}var c={container_type:"table",container_child:"tbody",label:"Element",allow_add:!0,allow_delete:!0,auto_add:!0,add_btn:{target:"",class:"btn btn-default",icon:"",text:"Ajouter un élément"},remove_btn:{target:"",class:"btn btn-default",icon:"fa fa-trash",text:"Supprimer"}};$.each(b,function(a,d){c[a]=b[a]});var d=$(c.container_type+"#"+a);if(c.allow_add){var e=$('<a href="#" id="add_category" class="'+c.add_btn.class+'">'+c.add_btn.text+"</a>");""==c.add_btn.target?d.append(e):d.find(c.add_btn.target).html(e),e.click(function(a){return h(d),a.preventDefault(),!1})}var f=d.find(":input").length;if(0==f&&c.auto_add)h(d);else{var g=c.container_type;""!=c.container_child&&(g=c.container_child),d.children(g).each(function(){c.allow_delete&&i($(this))}),$(".select2").select2()}$(".select2").select2()}function dywee_handle_delete_btn(){$('[data-action="ajax-delete"]').unbind("click").click(function(a){a.preventDefault();var b=$(this),c=b.html();b.html('<i class="fa fa-spinner fa-spin"></i>');var d=$(this).attr("data-route")?Routing.generate($(this).attr("data-route"),{id:$(this).attr("data-id")}):$(this).attr("href"),e=$("#dataConfirmModal");e.length||(e=$('<div class="modal fade" id="dataConfirmModal" role="dialog" aria-labelledby="dataConfirmLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">Attention!</h4></div><div class="modal-body"><p><i class="fa fa-spinner fa-spin"></i> Veuillez patienter </p></div><div class="modal-footer"><a class="btn btn-danger" id="dataConfirmOK">Supprimer</a><button type="button" class="btn btn-default" data-dismiss="modal" id="dataConfirmAboard">Annuler</button></div></div></div></div>'),$("body").append(e));var f="<p>Etes-vous sur de vouloir supprimer cet élément?</p>",g=$(this).attr("data-text");return"undefined"!=typeof g&&""!=g&&(f+="<p>(Sera supprimé: <b>"+g+"</b>)</p>"),f+="<p>Cette action est irréversible.</p>",e.find(".modal-body").html(f),e.on("hide.bs.modal",function(){b.html(c)}),$("#dataConfirmOK").click(function(a){$confirmBtn=$(this),$confirmBtn.addClass("disabled").html('<i class="fa fa-spinner fa-spin"></i> Veuillez patienter'),$.post(d,function(a){a=JSON.parse(a),"success"==a.type||"success"==a.status?($("#dataConfirmModal").modal("hide"),$confirmBtn.removeClass("disabled").html("Supprimer"),b.html(c),b.closest(b.attr("data-container")).fadeOut("slow")):($modal=$("#dywee-modal"),$modal.find(".modal-header").html("<h1>Erreur</h1>"),$modal.find(".modal-body").html("<p>Une erreur est survenue pendant la suppression</p><p>Veuillez contacter un administrateur</p>"),b=$('<button type="button" class="btn btn-default">Fermer</button>'),$modal.find(".modal-footer").html(b),$modal.modal("show"))})}),e.modal({show:!0}),!1})}function dywee_reset_handler(a){"delete_button"==a&&dywee_handle_delete_btn()}$(document).ready(function(){dywee_handle_delete_btn(),$(".select2").select2()}),function(a){a.fn.preload=function(b){function d(b){b.on("click",function(d){d.preventDefault(),c.loaded||(c.isBtnModified=!0,c.btnContent=a(this).html(),a(this).find("i").attr("class","fa fa-spinner fa-spin")),c.$btn=a(this);var e=setInterval(function(){c.loaded&&(clearInterval(e),c.btnContent&&c.isBtnModified&&(c.isBtnModified=!1,c.$btn.html(c.btnContent)),c.callback?c.callback(c.data,c):(console.log("[Preload][Error] No callback defined for btn"),console.log(b)))},500)})}function e(){a.post({url:c.compiledRoute,dataType:"json",data:c.ajaxData,success:function(a){"success"==a.status?(c.data=a,c.loaded=!0):console.log("Erreur dans une requête ajax (btn: "+c.btn+")")}})}function f(b){console.log(b.attr("href")),"#"!=b.attr("href")&&""!=b.attr("href")&&(c.compiledRoute=b.attr("href")),c.route&&(a.isEmptyObject(c.routingData)?c.compiledRoute=Routing.generate(c.route):c.compiledRoute=Routing.generate(c.route,c.routingData)),console.log("ici"),console.log(c.compiledRoute)}var c=a.extend({btn:null,route:null,routingData:{},ajaxData:{},btnContent:null,data:null,callback:null,loaded:!1,compiledRoute:null,$btn:null,isBtnModified:!1},b);f(this),d(this),e()}}(jQuery);